<!doctype html>
<html lang="en">
<head>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
          integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn"
          crossorigin="anonymous">
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Кофе хочешь?</title>
    <style>
        body {
            background-image: url("https://proprikol.ru/wp-content/uploads/2020/08/kartinki-kofe-38.jpg");
            background-size: cover;
            background-color: rgba(38, 38, 38, 0.47);
        }

        .round-cir {
            border-radius: 50%;
            width: 40px;
            height: 40px;
            vertical-align: middle;
        }

        .coffee_txt {
            align-items: center;
        }

        .pot {
            display: flex;
            flex-direction: column;
            gap: .5rem;
            padding: 1rem 2rem;
            background-color: rgba(65, 65, 65, 0.85);
        }

        .gap {
            margin-top: 2rem;
            display: flex;
            gap: 1rem;
        }

        .coffee_txt > span {
            font-size: 1.5rem;
            font-weight: 700;
            margin-left: 1rem;
        }

        #money img {
            height: 150px;
        }

        #money img:hover {
            cursor: pointer;
            filter: contrast(150%);

        }

        .orders {
            height: 200px;
            overflow: scroll;
            background-color: rgba(65, 65, 65, 0.85);
            font-size: 1.25rem;
            font-weight: 600;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <div class="row mx-0">
        <div class="col-md-6 pot text-white">
            <div onclick="getCoffee(55, 'Латте')" class="row coffee_txt">
                <div class="btn btn-success round-cir">
                </div>
                <span>Латте - 55 рублей</span>
            </div>
            <div onclick="getCoffee(100, 'Мокко')" class="row coffee_txt">
                <div class="btn btn-success round-cir">
                </div>
                <span>Мокко - 100 рублелй</span>
            </div>
            <div onclick="getCoffee(131, 'Американо')" class="row coffee_txt">
                <div class="btn btn-success round-cir">
                </div>
                <span>Американо - 131 рублелй</span>
            </div>
            <div onclick="getCoffee(200, 'Эспрессо')" class="row coffee_txt">
                <div class="btn btn-success round-cir">
                </div>
                <span>Эспрессо - 200 рублелй</span>
            </div>
            <div onclick="getCoffee(70, 'Чай')" class="row coffee_txt">
                <div class="btn btn-success round-cir">
                </div>
                <span>Чай - 70 рублелй</span>
            </div>
        </div>
        <div class="col-md-6 d-flex flex-column">
            <div class="row mx-0">
                <div class="col-md-6 bg-success rounded-sm p-3 text-center text-white">
                    <div class="" id="display" style="height: 100px">
                        Внесите деньги
                    </div>
                </div>
                <div class="col-md-6 d-flex">
                    <button class="btn btn-primary flex-grow-1" onclick="getChange()">Забрать сдачу</button>
                </div>
            </div>
            <!--            <button class="btn btn-danger" onclick="getCoffee()">Получить кофе</button>-->
            <div class="row mx-0 mt-2">
                <label>
                    <img src="images/money/bill-acc.png" alt="">
                    <input id="money_input" class="input mr-2" disabled type="number" placeholder="Сюда деньги">
                </label>
            </div>
            <div class=" text-white px-2 orders flex-grow-1 mt-2">
                <ol reversed id="orders">

                </ol>
            </div>
        </div>
    </div>
    <div class="gap text-white" id="money">
    <img src="./images/money/500rub.jpg" data-money="500" alt="">
    <img src="./images/money/100rub.jpg" data-money="100" alt="">
    <img src="./images/money/50rub.jpg" data-money="50" alt="">
    </div>
</div>
</body>
<script>
    let bills = document.querySelectorAll('img[src$="rub.jpg"]');
    let bill_acc = document.querySelector('img[src$="bill-acc.png"]');

    bills.forEach(bill => {
        bill.onmousedown = (e) => {
            bill = e.currentTarget;
            bill.style.position = 'absolute';
            bill.style.zIndex = '10000';
            bill.style.transform = 'rotate(90deg)';
            document.addEventListener('mousemove', moveAt);
        };
        bill.onmouseup = () => {
            document.removeEventListener('mousemove', moveAt);
            bill.style.zIndex = 1;
            // bill.style.transform = 'rotate(0deg)';

            let bill_top = bill.getBoundingClientRect().top;
            let bill_left = bill.getBoundingClientRect().left;
            let bill_right = bill.getBoundingClientRect().right;
            let bill_acc_top = bill_acc.getBoundingClientRect().top;
            let bill_acc_left = bill_acc.getBoundingClientRect().left;
            let bill_acc_right = bill_acc.getBoundingClientRect().right;
            let bill_acc_bottom = bill_acc.getBoundingClientRect().bottom - (bill_acc.getBoundingClientRect().height / 3) * 2;
            if (bill_top > bill_acc_top
                && bill_left > bill_acc_left
                && bill_right < bill_acc_right
                && bill_top < bill_acc_bottom) {
                bill.hidden = true;
                money.value = +money.value + +bill.dataset.money;
                    display.innerHTML = money.value + " рублей";

            }

        };
        bill.ondragstart = function () {
            return false;
        };
        const moveAt = (e) => {
            let x = e.clientX - 149;
            let y = e.clientY - 62;
            bill.style.top = y + 'px';
            bill.style.left = x + 'px';
        };
    });


    let money = document.getElementById('money_input');
    money.value = 0;
    let display = document.getElementById('display');
    // const insertMoney = (e) => {
    //     money.value = +money.value + +e.target.getAttribute('data-money');
    //     // e.target.remove();
    //     display.innerHTML = money.value + " рублей";
    // };

    const getChange = () => {
        if (money.value > 0) {
            while (money.value != 0) {
                if (money.value >= 500) {
                    document.getElementById('money').insertAdjacentHTML("afterbegin",
                        `<img src="./images/money/500rub.jpg" data-money="500" alt="">`);
                    money.value -= 500;
                    display.innerHTML = money.value + " рублей";
                } else if (money.value >= 100) {
                    document.getElementById('money').insertAdjacentHTML("afterbegin",
                        `<img src="./images/money/100rub.jpg" data-money="100" alt="">`);
                    money.value -= 100;
                    display.innerHTML = money.value + " рублей";
                } else if (money.value >= 50) {
                    document.getElementById('money').insertAdjacentHTML("afterbegin",
                        `<img src="./images/money/50rub.jpg" data-money="50" alt="">`);
                    money.value -= 50;
                    display.innerHTML = money.value + " рублей";
                } else if (money.value >= 10) {
                    document.getElementById('money').insertAdjacentHTML("afterbegin",
                        `<img src="./images/money/10rub.png" data-money="10" alt="">`);
                    money.value -= 10;
                    display.innerHTML = money.value + " рублей";
                } else if (money.value >= 5) {
                    document.getElementById('money').insertAdjacentHTML("afterbegin",
                        `<img src="./images/money/5rub.png" data-money="5" alt="">`);
                    money.value -= 5;
                    display.innerHTML = money.value + " рублей";
                } else if (money.value >= 2) {
                    document.getElementById('money').insertAdjacentHTML("afterbegin",
                        `<img src="./images/money/2rub.png" data-money="2" alt="">`);
                    money.value -= 2;
                    display.innerHTML = money.value + " рублей";
                } else if (money.value >= 1) {
                    document.getElementById('money').insertAdjacentHTML("afterbegin",
                        `<img src="./images/money/1rub.png" data-money="1" alt="">`);
                    money.value -= 1;
                    display.innerHTML = money.value + " рублей";
                }
            }
            document.getElementById('orders').insertAdjacentHTML('afterbegin', "<li>Сдача выдана</li>");
            display.innerHTML = 'Внесите деньги';
        } else {
            document.getElementById('orders').insertAdjacentHTML("afterbegin", `<li style="color: orange"> Чтобы получить сдачу нужно пополнить счет</li>`);
        }
    };

    const getCoffee = (price, name) => {
        if (money.value >= price) {
            console.log(`${name} готов!`);
            money.value -= price;
            display.innerHTML = money.value + " рублей";
            const b = document.getElementById('orders');
            b.insertAdjacentHTML("afterbegin", `<li> ${name} - ${price} рублей</li>`);
        } else {
            document.getElementById('orders').insertAdjacentHTML("afterbegin", `<li style="color: red"> Недостаточно денег</li>`);
        }
    };
</script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
        crossorigin="anonymous"></script>
</html>